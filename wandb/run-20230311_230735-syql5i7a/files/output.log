Epoch 1/5:   0%|          | 0/18 [00:00<?, ?img/s]/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: BICUBIC is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.BICUBIC instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/home/mikhail/.local/lib/python3.10/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
input.size() =  torch.Size([1, 128, 128])
target.size() =  torch.Size([1, 128, 128])
Epoch 1/5:   6%|▌         | 1/18 [00:04<01:14,  4.36s/img, loss (batch)=1.54]
input.size() =  torch.Size([1, 128, 128])


Epoch 1/5:  17%|█▋        | 3/18 [00:08<00:37,  2.53s/img, loss (batch)=1.46]
input.size() =  torch.Size([1, 128, 128])
target.size() =  torch.Size([1, 128, 128])
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
/tmp/ipykernel_42889/3229571025.py:158: DeprecationWarning: NEAREST is deprecated and will be removed in Pillow 10 (2023-07-01). Use Resampling.NEAREST or Dither.NONE instead.
  pil_img = pil_img.resize((newW, newH), resample=Image.NEAREST if is_mask else Image.BICUBIC)
batch =  {'image': tensor([[[[0.3569, 0.5137, 0.5333,  ..., 0.5961, 0.5843, 0.6039],
          [0.3255, 0.3882, 0.4510,  ..., 0.3412, 0.3176, 0.4000],
          [0.2353, 0.2667, 0.2902,  ..., 0.3098, 0.2863, 0.5020],
          ...,
          [0.1608, 0.1647, 0.1608,  ..., 0.2235, 0.2314, 0.2235],
          [0.1059, 0.1373, 0.1608,  ..., 0.2235, 0.1843, 0.1686],
          [0.1098, 0.1255, 0.1608,  ..., 0.2902, 0.1686, 0.1569]],
         [[0.3137, 0.4667, 0.4706,  ..., 0.5490, 0.5529, 0.5765],
          [0.2941, 0.3451, 0.3961,  ..., 0.3020, 0.2941, 0.3804],
          [0.2039, 0.2275, 0.2392,  ..., 0.2706, 0.2667, 0.4824],
          ...,
          [0.1412, 0.1451, 0.1373,  ..., 0.1922, 0.2157, 0.2078],
          [0.0902, 0.1216, 0.1412,  ..., 0.1843, 0.1647, 0.1608],
          [0.0941, 0.1098, 0.1451,  ..., 0.2510, 0.1490, 0.1529]],
         [[0.2235, 0.3843, 0.4000,  ..., 0.4706, 0.5020, 0.6000],
          [0.2118, 0.2667, 0.3176,  ..., 0.2196, 0.2353, 0.4000],
          [0.1294, 0.1451, 0.1529,  ..., 0.1725, 0.1961, 0.4941],
          ...,
          [0.0941, 0.0941, 0.0902,  ..., 0.1529, 0.1804, 0.2314],
          [0.0471, 0.0745, 0.0941,  ..., 0.1490, 0.1373, 0.1961],
          [0.0549, 0.0667, 0.0980,  ..., 0.2157, 0.1294, 0.1922]]]]), 'mask': tensor([[[0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         ...,
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0]]])}
image.size =  torch.Size([1, 3, 128, 128])
mask_true.size =  torch.Size([1, 128, 128])
input.size() =  torch.Size([1, 1, 128, 128])
target.size() =  torch.Size([1, 128, 128])
Epoch 1/5:  17%|█▋        | 3/18 [00:37<03:06, 12.42s/img, loss (batch)=1.46]
100%|██████████| 19/19 [00:00<00:00, 26.03it/s]